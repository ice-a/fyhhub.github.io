(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{526:function(e,t,a){"use strict";a.r(t);var r=a(11),v=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"hmr原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hmr原理"}},[e._v("#")]),e._v(" HMR原理")]),e._v(" "),a("p",[a("img",{attrs:{src:"http://tva1.sinaimg.cn/large/006vSZ9Ugy1gwpywu1c5tj30md0n945o.jpg",alt:"image.png"}})]),e._v(" "),a("h2",{attrs:{id:"server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#server"}},[e._v("#")]),e._v(" Server")]),e._v(" "),a("ol",[a("li",[e._v("调用"),a("code",[e._v("webpack")]),e._v("获取compiler对象")]),e._v(" "),a("li",[e._v("更改config的entry属性 (entryOption hook)，增加client/index.js和hot/dev-server.js")]),e._v(" "),a("li",[e._v("监听done钩子，编译完成后会把"),a("code",[e._v("hash")]),e._v("发送给客户端， 并发送一个ok")]),e._v(" "),a("li",[e._v("webpack-dev-middleware 修改文件系统，这样webpack编译后的文件会直接写到内存中。")]),e._v(" "),a("li",[e._v("创建Server")]),e._v(" "),a("li",[e._v("创建Socket, 在建立完连接后，会先向客户端发送一个初始hash")])]),e._v(" "),a("h2",{attrs:{id:"client"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#client"}},[e._v("#")]),e._v(" client")]),e._v(" "),a("ol",[a("li",[e._v("当接收到 type 为 hash 消息后会将 hash 值暂存起来，当接收到 type 为 ok 的消息后对应用执行 reload 操作")]),e._v(" "),a("li",[e._v("在 reload 操作中，webpack-dev-server/client 会根据 hot 配置决定是刷新浏览器还是对代码进行热更新（HMR）")]),e._v(" "),a("li",[e._v("发送"),a("code",[e._v("webpackHotUpdate")]),e._v("消息，调用"),a("code",[e._v("webpack/lin/dev-server")]),e._v(", 发送ajax请求，是否有更新的文件。如果有就用过jsonp请求最新的模块代码")])])])}),[],!1,null,null,null);t.default=v.exports}}]);